<!DOCTYPE HTML>
<html>
	<head>
		<meta name="viewport" content="width=device-width">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<script src="jquery.min.js"></script>
		<script src="highcharts.3.0.5.js"></script>
		<script type="text/javascript">	
			function plotChart(chartOptions, customOptions) {	
				$("#loading").show();

				try {
			        var config = {
			        	credits: {
			        		enabled: false	
			        	},
			        	
			        	exporting: {
			        		enabled: false	
			        	},
			        	
			            chart: {
			            	renderTo: 'container',
			                plotBackgroundColor: null,
			                plotBorderWidth: null,
			                plotShadow: false,
							height: customOptions.chartHeight,
							events: {
								load: function() {
									console.log('loading widget finished');
									$("#loading").hide();
								}
							}
			            },
			            
			            title: {
			                text: chartOptions.name
			            },
			            
			            tooltip: {
			        	    pointFormat: '{series.name}: <b>{point.y}</b>'
			            },
			           
			            plotOptions: {
			                column: {
			                    allowPointSelect: true,
			                    cursor: 'pointer',
			                    dataLabels: {
			                        enabled: false
			                    },
			                    showInLegend: false,
			                    color: {
								    linearGradient: { x1: 0, x2: 0, y1: 1, y2: 0 },
								    stops: [
								        [0, '#8D00FF'],
								        [1, '#00E59D']
								    ]		                    	
			                    }
			                }
			            },
			            
			            xAxis: {
			            	//tickPixelInterval: 1,
				            //tickInterval: 1,
				            labels: {
				                enabled: true
				            }	
			            },
			            
			            yAxis: {
			            	title: {
			            		text: null
			            	}	
			            },
			            
			            series: [chartOptions]	        	
			        };
			      
			        if(customOptions.showGoalSteps == 1) {			        	
			      		config.yAxis.plotLines = [{
		            		value: customOptions.goalSteps * 1,
		            		color: '#22DA9B',
		            		width: 2
		            	}];
			        }
			        
			        if(customOptions.useMonthFormatter == 1) {			        	
			        	config.xAxis.labels.formatter = function() {			                	
			            	var labels = [
			            		'January',
			            		'February',
			            		'March',
			            		'April',
			            		'May',
			            		'June',
			            		'July',
			            		'August',
			            		'September',
			            		'October',
			            		'November',
			            		'December'
			            	];
			            	
			            	return labels[this.value - 1].substring(0, 3);
						};
			        }
			        
			        // Wait a second to give the view a chance to render properly.
			        setTimeout(function() {
			       		new Highcharts.Chart(config);
			        }, 1000);
				}
				catch(e) {
					alert(e);	
					$("#loading").hide();
				}

				setTimeout(function() {
					// hide the loading spinner after 5 seconds, just in case the load event failed
					$("#loading").hide();
				}, 5000);
			}
		</script>

		<style>
			#loading {
				width: 100px;
				height: 100px;
				position: absolute;
				top:0;
				bottom: 0;
				left: 0;
				right: 0;
				margin: auto;

				border-radius: 5px;
			}
		</style>
	</head>

	<body>
		<div id="container"></div>
		<div id="loading">
			<img src="loading.gif"/>
		</div>
	</body>
</html> 
